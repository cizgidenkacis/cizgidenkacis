<!doctype html>
<html lang="tr">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>√áizgiden Ka√ßƒ±≈ü ‚Äî √áalƒ±≈üan S√ºr√ºm</title>
<style>
  html,body{height:100%;margin:0;font-family:Arial,Helvetica,sans-serif;user-select:none;background:#fff;
    background-image: repeating-linear-gradient(45deg,#eee 0,#eee 10px,#fff 10px,#fff 20px);}
  #mainMenu{position:absolute;inset:0;display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:5}
  #mainMenu h1{font-size:48px;color:#000;margin:0 0 18px 0}
  .menuBtn{padding:14px 34px;font-size:20px;border-radius:12px;border:0;background:#000;color:#fff;cursor:pointer}
  canvas{position:fixed;inset:0;display:block}
  #scoreBox{position:fixed;left:14px;top:14px;background:rgba(0,0,0,0.7);color:#fff;padding:10px 14px;border-radius:10px;font-weight:700;display:none;z-index:4}
  #pauseBtn,#homeBtn,#restartBtn{position:fixed;top:14px;right:14px;padding:8px 12px;border-radius:8px;border:0;background:#222;color:#fff;cursor:pointer;display:none;z-index:4}
  #homeBtn{right:110px}
  #restartBtn{display:none;left:50%;top:50%;transform:translate(-50%,-50%);font-size:20px;padding:12px 20px;background:#e74c3c}
</style>
</head>
<body>

<div id="mainMenu">
  <h1>√áizgiden Ka√ßƒ±≈ü</h1>
  <button id="startBtn" class="menuBtn">Ba≈üla</button>
</div>

<canvas id="gameCanvas"></canvas>

<div id="scoreBox">Skor: 0<br>Seviye: 1</div>
<button id="pauseBtn">Dur</button>
<button id="homeBtn">Ana Men√º</button>
<button id="restartBtn">Tekrar Oyna</button>

<script>
/* ====== Basit, saƒülam ve √ßalƒ±≈üan oyun kodu ====== */

/* Elemanlar */
const startBtn = document.getElementById('startBtn');
const mainMenu = document.getElementById('mainMenu');
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
const scoreBox = document.getElementById('scoreBox');
const pauseBtn = document.getElementById('pauseBtn');
const homeBtn = document.getElementById('homeBtn');
const restartBtn = document.getElementById('restartBtn');

/* Canvas boyutlandƒ±rma */
function resizeCanvas(){
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
window.addEventListener('resize', resizeCanvas);
resizeCanvas();

/* Oyun durumu */
let running = false;
let paused = false;
let gameOver = false;
let score = 0;
let level = 1;
let highScore = Number(localStorage.getItem('highScore')||0);
let obstacles = [];
let lastTime = 0;
let spawnAccumulator = 0;

/* Player (sadece dikey hareket - s√ºr√ºkleyerek) */
const player = {
  x: 80,
  y: canvas.height/2,
  size: 64,
  emoji: 'üêµ'
};

/* Kontrol: mouse/touch drag ile dikey konum */
let dragging = false;
canvas.addEventListener('pointerdown', (e)=>{ dragging = true; canvas.setPointerCapture(e.pointerId); handlePointerMove(e); });
canvas.addEventListener('pointerup', (e)=>{ dragging = false; try{canvas.releasePointerCapture(e.pointerId);}catch(e){} });
canvas.addEventListener('pointermove', (e)=>{ if(dragging && running && !paused && !gameOver) handlePointerMove(e); });
function handlePointerMove(e){
  const rect = canvas.getBoundingClientRect();
  const y = e.clientY - rect.top;
  player.y = Math.max(0, Math.min(canvas.height - player.size, y - player.size/2));
}

/* Buton olaylarƒ± */
startBtn.addEventListener('click', ()=>{ startGame(); });
pauseBtn.addEventListener('click', ()=>{ paused = !paused; pauseBtn.textContent = paused ? 'Devam' : 'Dur'; });
homeBtn.addEventListener('click', ()=>{ backToMenu(); });
restartBtn.addEventListener('click', ()=>{ restartBtn.style.display='none'; startGame(); });

/* Engel √ºretimi (yukarƒ±dan, yatay geni≈ülik sabit, t√ºm hƒ±z e≈üit) */
function spawnObstacle(){
  const w = Math.min(220, Math.max(120, Math.floor(canvas.width * 0.18))); // sabit geni≈ülik aralƒ±ƒüƒ±
  const x = Math.random()*(canvas.width - w - 20) + 10; // yatay konum rastgele
  const y = -18; // yukarƒ±dan ba≈üla
  const h = 14;  // engel y√ºksekliƒüi (√ßizgi hissi)
  const speed = 5; // t√ºm engeller e≈üit hƒ±z
  obstacles.push({x,y,w,h,speed});
}

/* G√ºncelleme */
function update(dt){
  if(!running || paused || gameOver) return;

  spawnAccumulator += dt;
  // spawn her ~0.9s
  if(spawnAccumulator > 900){
    spawnAccumulator = 0;
    spawnObstacle();
  }

  // engelleri hareket ettir
  for(let i = obstacles.length -1; i>=0; i--){
    let o = obstacles[i];
    o.y += o.speed * (dt/16);
    if(o.y > canvas.height + 40){
      obstacles.splice(i,1);
      score++;
      level = Math.floor(score/150) + 1; // her 150'de level artar
    } else {
      // √ßarpƒ±≈üma kontrol√º
      const pr = {x:player.x, y:player.y, w:player.size, h:player.size};
      const or = {x:o.x, y:o.y, w:o.w, h:o.h};
      if(rectIntersect(pr,or)){
        doGameOver();
        return;
      }
    }
  }
}

/* √áarpƒ±≈üma kutusu fonksiyonu */
function rectIntersect(a,b){
  return !(b.x > a.x + a.w || b.x + b.w < a.x || b.y > a.y + a.h || b.y + b.h < a.y);
}

/* √áizim */
function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // arka plan (hafif gradient)
  const g = ctx.createLinearGradient(0,0,0,canvas.height);
  g.addColorStop(0, '#4e54c8'); g.addColorStop(1, '#8f94fb');
  ctx.fillStyle = g; ctx.fillRect(0,0,canvas.width,canvas.height);

  // engeller
  ctx.fillStyle = '#000';
  obstacles.forEach(o => ctx.fillRect(o.x, o.y, o.w, o.h));

  // player (emoji)
  ctx.font = player.size + 'px "Segoe UI Emoji", "Noto Color Emoji", serif';
  ctx.textBaseline = 'top';
  ctx.fillText(player.emoji, player.x, player.y);

  // UI: scoreBox g√ºncelleniyor via DOM below
}

/* Oyun d√∂ng√ºs√º */
function loop(timestamp){
  if(!lastTime) lastTime = timestamp;
  const dt = timestamp - lastTime;
  lastTime = timestamp;

  update(dt);
  draw();
  // DOM g√ºncellemesi
  scoreBox.style.display = running ? 'block':'none';
  if(running){
    scoreBox.innerHTML = `Skor: ${score}<br>En Y√ºksek: ${highScore}<br>Seviye: ${level}`;
    pauseBtn.style.display = paused? 'block' : 'block';
    homeBtn.style.display = 'block';
  }

  if(running) requestAnimationFrame(loop);
}

/* Ba≈ülat */
function startGame(){
  // reset
  running = true;
  paused = false;
  gameOver = false;
  score = 0;
  level = 1;
  obstacles = [];
  player.y = canvas.height/2;
  lastTime = 0;
  spawnAccumulator = 0;

  // gizle men√º
  mainMenu.style.display = 'none';
  restartBtn.style.display = 'none';
  scoreBox.style.display = 'block';
  pauseBtn.style.display = 'block';
  homeBtn.style.display = 'block';

  // ba≈ülat d√∂ng√º
  requestAnimationFrame(loop);
}

/* Men√ºye d√∂n */
function backToMenu(){
  running = false;
  paused = false;
  gameOver = false;
  obstacles = [];
  mainMenu.style.display = 'flex';
  scoreBox.style.display = 'none';
  pauseBtn.style.display = 'none';
  homeBtn.style.display = 'none';
  restartBtn.style.display = 'none';
}

/* Game over */
function doGameOver(){
  gameOver = true;
  running = false;
  restartBtn.style.display = 'block';
  if(score > highScore){ highScore = score; localStorage.setItem('highScore', highScore); }
}

/* Restart butonu already shows and calls startGame() */

</script>
</body>
</html>
