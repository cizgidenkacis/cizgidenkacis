<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Ã‡izgiden KaÃ§Ä±ÅŸ</title>

<style>
    body {
        margin: 0;
        overflow: hidden;
        user-select: none;
        background: #fff;
        font-family: Arial, sans-serif;
        touch-action: manipulation;
    }

    #mainMenu {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        text-align: center;
        color: black;
        z-index: 50;
    }

    .menuBtn {
        padding: 18px 40px;
        font-size: 30px;
        background: black;
        color: white;
        border-radius: 12px;
        border: none;
        cursor: pointer;
    }

    #scoreBox {
        position: absolute;
        top: 15px;
        left: 15px;
        padding: 12px 22px;
        background: rgba(0,0,0,0.2);
        color: black;
        font-size: 26px;
        border-radius: 12px;
        display: none;
        z-index: 30;
    }

    #mobile-controls {
        position: fixed;
        bottom: 25px;
        width: 100%;
        display: flex;
        justify-content: center;
        gap: 60px;
        z-index: 40;
        pointer-events: auto;
    }

    #mobile-controls button {
        width: 95px;
        height: 95px;
        font-size: 42px;
        border: none;
        border-radius: 50%;
        background: rgba(0,0,0,0.6);
        color: white;
        backdrop-filter: blur(5px);
    }

    #restartBtn {
        display:none;
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        padding: 16px 36px;
        background: #ff5c5c;
        color: white;
        border: none;
        font-size: 26px;
        border-radius: 12px;
        cursor: pointer;
        z-index: 60;
    }
</style>
</head>
<body>

<div id="mainMenu">
    <h1 style="font-size:55px;">Ã‡izgiden KaÃ§Ä±ÅŸ</h1>
    <button class="menuBtn" id="startBtn">BaÅŸla</button>
</div>

<canvas id="gameCanvas"></canvas>

<div id="scoreBox">Skor: 0<br>En YÃ¼ksek: 0</div>

<div id="mobile-controls" style="display:none;">
    <button id="leftBtn">â—€</button>
    <button id="rightBtn">â–¶</button>
</div>

<button id="restartBtn">Tekrar Oyna</button>

<script>
/* --- TEMEL DEÄžÄ°ÅžKENLER --- */
let gameRunning = false;
let gameOver = false;

const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");

function resizeCanvas() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
}
resizeCanvas();
window.addEventListener("resize", resizeCanvas);

let player = {
    x: canvas.width / 2,
    y: canvas.height * 0.75,
    size: 60,
    emoji: "ðŸµ",
};

let obstacles = [];
let score = 0;
let highScore = Number(localStorage.getItem("highScore") || 0);

let moveLeft = false;
let moveRight = false;
let speed = 7;

/* --- MOBÄ°L KONTROLLER --- */
leftBtn.addEventListener("touchstart", () => moveLeft = true);
leftBtn.addEventListener("touchend", () => moveLeft = false);

rightBtn.addEventListener("touchstart", () => moveRight = true);
rightBtn.addEventListener("touchend", () => moveRight = false);

/* --- KLAVYE KONTROLÃœ --- */
document.addEventListener("keydown", (e) => {
    if (e.key === "ArrowLeft") moveLeft = true;
    if (e.key === "ArrowRight") moveRight = true;
});
document.addEventListener("keyup", (e) => {
    if (e.key === "ArrowLeft") moveLeft = false;
    if (e.key === "ArrowRight") moveRight = false;
});

/* --- OYUN BAÅžLAT --- */
document.getElementById("startBtn").onclick = startGame;
document.getElementById("restartBtn").onclick = resetGame;

function startGame() {
    console.log("Oyun baÅŸlatÄ±lÄ±yor...");

    document.getElementById("mainMenu").style.display = "none";
    document.getElementById("scoreBox").style.display = "block";
    document.getElementById("mobile-controls").style.display = "flex";

    gameRunning = true;
    gameOver = false;
    score = 0;
    obstacles = [];

    loop();
}

/* --- ENGEL --- */
function spawnObstacle() {
    obstacles.push({
        x: Math.random() * (canvas.width - 120),
        y: -20,
        w: 120,
        h: 10,
        speed: 6
    });
}

/* --- OYUN RESET --- */
function resetGame() {
    restartBtn.style.display = "none";
    startGame();
}

/* --- UPDATE --- */
function update() {
    if (!gameRunning || gameOver) return;

    if (moveLeft) player.x -= speed;
    if (moveRight) player.x += speed;

    if (player.x < 0) player.x = 0;
    if (player.x > canvas.width - player.size) player.x = canvas.width - player.size;

    obstacles.forEach((o, i) => {
        o.y += o.speed;

        if (o.y > canvas.height) {
            obstacles.splice(i, 1);
            score++;
        }

        if (
            player.x < o.x + o.w &&
            player.x + player.size > o.x &&
            player.y < o.y + o.h &&
            player.y + player.size > o.y
        ) {
            endGame();
        }
    });

    if (Math.random() < 0.025) spawnObstacle();
}

/* --- Ã‡Ä°ZÄ°M --- */
function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    ctx.font = player.size + "px serif";
    ctx.fillText(player.emoji, player.x, player.y);

    ctx.fillStyle = "#ff2b2b";
    obstacles.forEach(o => {
        ctx.fillRect(o.x, o.y, o.w, o.h);
    });

    scoreBox.innerHTML = "Skor: " + score + "<br>En YÃ¼ksek: " + highScore;
}

/* --- GAME OVER --- */
function endGame() {
    gameOver = true;
    gameRunning = false;
    restartBtn.style.display = "block";

    if (score > highScore) {
        highScore = score;
        localStorage.setItem("highScore", highScore);
    }
}

/* --- OYUN LOOPU --- */
function loop() {
    update();
    draw();
    if (gameRunning) requestAnimationFrame(loop);
}
</script>

</body>
</html>
