<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Ã‡izgiden KaÃ§Ä±ÅŸ</title>

<style>
    body {
        margin: 0;
        overflow: hidden;
        user-select: none;
        background: #ffffff;
        font-family: Arial, sans-serif;
    }

    #mainMenu {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        text-align: center;
        color: black;
    }
    .menuBtn {
        padding: 18px 40px;
        font-size: 30px;
        background: black;
        color: white;
        border-radius: 12px;
        border: none;
        cursor: pointer;
    }

    #mobile-controls {
        position: fixed;
        bottom: 25px;
        width: 100%;
        display: flex;
        justify-content: center;
        gap: 60px;
        z-index: 2000;
    }
    #mobile-controls button {
        width: 95px;
        height: 95px;
        font-size: 42px;
        border: none;
        border-radius: 50%;
        background: rgba(0,0,0,0.6);
        color: white;
        backdrop-filter: blur(5px);
    }

    #scoreBox {
        position: absolute;
        top: 15px;
        left: 15px;
        padding: 12px 22px;
        background: rgba(0,0,0,0.2);
        color: black;
        font-size: 26px;
        border-radius: 12px;
        display: none;
    }

    #restartBtn {
        display:none;
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        padding: 16px 36px;
        background: #ff5c5c;
        color: white;
        border: none;
        font-size: 26px;
        border-radius: 12px;
        cursor: pointer;
    }
</style>
</head>
<body>

<div id="mainMenu">
    <h1 style="font-size:55px;">Ã‡izgiden KaÃ§Ä±ÅŸ</h1>
    <button class="menuBtn" onclick="startGame()">BaÅŸla</button>
</div>

<canvas id="gameCanvas"></canvas>
<div id="scoreBox">Skor: 0<br>En YÃ¼ksek: 0</div>

<div id="mobile-controls" style="display:none;">
    <button id="leftBtn">â—€</button>
    <button id="rightBtn">â–¶</button>
</div>

<button id="restartBtn" onclick="resetGame()">Tekrar Oyna</button>

<script>
let gameRunning = false;
let gameOver = false;

const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");

canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let player = {
    x: canvas.width / 2,
    y: canvas.height * 0.75,
    size: 60,
    emoji: "ðŸµ",
};

let obstacles = [];
let score = 0;
let highScore = Number(localStorage.getItem("highScore") || 0);

let moveLeft = false;
let moveRight = false;

let baseMoveSpeed = 9;    // bilgisayar + mobil eÅŸit hÄ±z
let obstacleBaseSpeed = 7;

let lastTime = 0;

/* --- MOBÄ°L KONTROLLER --- */
leftBtn.addEventListener("touchstart", () => moveLeft = true);
leftBtn.addEventListener("touchend", () => moveLeft = false);
rightBtn.addEventListener("touchstart", () => moveRight = true);
rightBtn.addEventListener("touchend", () => moveRight = false);

/* --- KLAVYE --- */
document.addEventListener("keydown", (e) => {
    if (e.key === "ArrowLeft") moveLeft = true;
    if (e.key === "ArrowRight") moveRight = true;
});
document.addEventListener("keyup", (e) => {
    if (e.key === "ArrowLeft") moveLeft = false;
    if (e.key === "ArrowRight") moveRight = false;
});

/* --- OYUN BAÅžLATMA --- */
function startGame() {
    mainMenu.style.display = "none";
    restartBtn.style.display = "none";
    scoreBox.style.display = "block";
    mobile-controls.style.display = "flex";

    gameRunning = true;
    gameOver = false;

    score = 0;
    obstacles = [];

    player.x = canvas.width / 2;

    requestAnimationFrame(gameLoop);
}

/* --- ENGEL OLUÅžTURMA --- */
function spawnObstacle() {
    obstacles.push({
        x: Math.random() * (canvas.width - 120),
        y: -20,
        w: 120,
        h: 12,
        speed: obstacleBaseSpeed
    });
}

/* --- GAME LOOP (FPS BAÄžIMSIZ) --- */
function gameLoop(timestamp) {
    let delta = (timestamp - lastTime) / 16.67;
    lastTime = timestamp;

    update(delta);
    draw();

    if (gameRunning) requestAnimationFrame(gameLoop);
}

/* --- UPDATE --- */
function update(delta) {
    if (!gameRunning || gameOver) return;

    if (moveLeft) player.x -= baseMoveSpeed * delta;
    if (moveRight) player.x += baseMoveSpeed * delta;

    if (player.x < 0) player.x = 0;
    if (player.x > canvas.width - player.size) player.x = canvas.width - player.size;

    obstacles.forEach((o, i) => {
        o.y += o.speed * delta;

        if (o.y > canvas.height) {
            obstacles.splice(i, 1);
            score++;
        }

        if (
            player.x < o.x + o.w &&
            player.x + player.size > o.x &&
            player.y < o.y + o.h &&
            player.y + player.size > o.y
        ) {
            return endGame();
        }
    });

    if (Math.random() < 0.025) spawnObstacle();
}

/* --- Ã‡Ä°ZÄ°M --- */
function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    ctx.font = player.size + "px serif";
    ctx.fillText(player.emoji, player.x, player.y);

    ctx.fillStyle = "#ff2b2b";
    obstacles.forEach(o => ctx.fillRect(o.x, o.y, o.w, o.h));

    scoreBox.innerHTML = "Skor: " + score + "<br>En YÃ¼ksek: " + highScore;
}

/* --- OYUN BÄ°TÄ°Åž --- */
function endGame() {
    gameRunning = false;
    gameOver = true;

    restartBtn.style.display = "block";

    if (score > highScore) {
        highScore = score;
        localStorage.setItem("highScore", highScore);
    }
}

/* --- RESET --- */
function resetGame() {
    startGame();
}
</script>

</body>
</html>
